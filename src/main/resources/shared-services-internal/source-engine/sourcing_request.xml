<?xml version="1.0" encoding="UTF-8"?>
<specification xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
               xmlns="https://magento.com/open-specification"
               xsi:schemaLocation="https://magento.com/open-specification ../specification.xsd">

    <module name="magento.source_engine">
        <service name="sourcing_request_management">
            <summary>Sourcing Request Management</summary>

            <command name="cancel">
                <summary>Cancel an existing Sourcing Request</summary>
                <extensible>false</extensible>
                <status>public</status>
                <arguments>
                    <argument name="sourcing_request_uuid">
                        <summary>Sourcing Request UUID</summary>
                        <type>string</type>
                        <required>true</required>
                    </argument>
                    <argument name="user">
                        <summary>User who cancelled the sourcing request</summary>
                        <type>string</type>
                        <required>false</required>
                    </argument>
                    <argument name="reason">
                        <summary>Reason to cancel the sourcing request</summary>
                        <type>string</type>
                        <required>false</required>
                    </argument>
                </arguments>
            </command>

            <event name="created">
                <summary>New Sourcing Request created event</summary>
                <extensible>false</extensible>
                <status>public</status>
                <arguments>
                    <argument name="sourcing_request">
                        <summary>Sourcing Request</summary>
                        <type>magento.source_engine.sourcing_request</type>
                        <required>true</required>
                    </argument>
                </arguments>
            </event>

            <event name="cancelled">
                <summary>Sourcing Request cancelled event</summary>
                <extensible>false</extensible>
                <status>public</status>
                <arguments>
                    <argument name="sourcing_request_uuid">
                        <summary>Sourcing Request UUID</summary>
                        <type>string</type>
                        <required>true</required>
                    </argument>
                </arguments>
            </event>

        </service>
        
        <struct name="sourcing_request">
            <summary>Entity representing multiple lines of an order to be sourced</summary>
            <extensible>true</extensible>
            <properties>
                <property name="uuid">
                    <summary>UUID of the Sourcing Request</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="mode">
                    <summary>Execution Mode for Sourcing Engine</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="order_uuid">
                    <summary>UUID of the Order</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="order_id">
                    <summary>Id of the Order</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="order_creation_date">
                    <summary>Creation Date of the Order</summary>
                    <type>datetime</type>
                    <required>true</required>
                </property>
                <property name="client">
                    <summary>Client ID</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="store_id">
                    <summary>Store ID</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="aggregate_id">
                    <summary>Aggregate ID</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="shipping_method">
                    <summary>Shipping Method</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="shipping_address">
                    <summary>Address of the Order</summary>
                    <type>magento.common.address</type>
                    <required>true</required>
                </property>
                <property name="lines">
                    <summary>Order Lines to be sourced.</summary>
                    <type>array[magento.source_engine.sourcing_request_line]</type>
                    <required>true</required>
                </property>
                <property name="custom_attributes">
                    <summary>Custom Attributes</summary>
                    <type>array[magento.common.custom_attribute]</type>
                    <required>false</required>
                </property>
            </properties>
        </struct>

        <struct name="sourcing_request_line">
            <summary>Sourcing Request Line</summary>
            <extensible>true</extensible>
            <properties>
                <property name="id">
                    <summary>Order Line ID</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="line_number">
                    <summary>Order Line Number</summary>
                    <type>integer</type>
                    <required>true</required>
                </property>
                <property name="sku">
                    <summary>SKU of the Item</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="product_type">
                    <summary>Product Type</summary>
                    <type>string</type>
                    <required>true</required>
                </property>
                <property name="parent_line_id">
                    <summary>Order Line External ID of the parent Line</summary>
                    <type>string</type>
                    <required>false</required>
                </property>
                <property name="allocation_attempts">
                    <summary>Number of allocation attempts of this Line</summary>
                    <type>integer</type>
                    <required>false</required>
                </property>
                <property name="source_id">
                    <summary>Source ID for lines already Hard Allocated</summary>
                    <type>string</type>
                    <required>false</required>
                </property>
                <property name="declined_sources">
                    <summary>Declined Sources for a Sourcing Line</summary>
                    <type>array[string]</type>
                    <required>false</required>
                </property>
                <property name="custom_attributes">
                    <summary>Custom Attributes</summary>
                    <type>array[magento.common.custom_attribute]</type>
                    <required>false</required>
                </property>
                <property name="source_location">
                    <summary>Identifier that will force the source to be used when sourcing the order</summary>
                    <description>Note: if no stock is available in this defined source, the order line will remain in backorder. If an order is a ISPU, this field will be used only when Ship To Store is enabled to force the source that will be providing the stock to the final collection point</description>
                    <type>string</type>
                    <required>false</required>
                </property>
                <property name="pickup_location">
                    <summary>Identifier that the customer selected as a collection point</summary>
                    <type>string</type>
                    <required>false</required>
                </property>
                <property name="quantity">
                    <summary>The quantity of the sourcing request</summary>
                    <type>integer</type>
                    <required>true</required>
                </property>
                <property name="promise_delivery_date">
                    <summary>Promise delivery date of the line</summary>
                    <type>datetime</type>
                    <required>false</required>
                </property>
            </properties>
        </struct>
    </module>
</specification>
